# .roomodes  —— project-level custom modes
customModes:
  - slug: main-agent
    name: Main Agent (Cloud Rules)
    model: gpt-5
    groups:
      - read
      - edit:
          # Main can edit cloud.md (rules) and seed docs, but NOT progress files.
          fileRegex: "(cloud\\.md|README\\.md)$"
      - use_mcp_tool
    roleDefinition: |
      You are the Main Agent for this project. Obey /memory/cloud.md as governing rules.
      When cloud.md triggers fire (e.g., words like 必須/決定/要完成), immediately
      start a Boomerang task to the "progress-recorder" mode with a /record payload.
      Never write to progress.md yourself; only the recorder may do so.
    settings:
      # Helpful to avoid runaway edits while we test
      autoApproveEdits: false

  - slug: progress-recorder
    name: Progress Recorder (External Memory)
    model: gpt-5
    groups:
      - read
      - edit:
          # Recorder can ONLY touch memory files:
          fileRegex: "(memory/progress(\\.archive)?\\.md)$"
      - use_mcp_tool
    roleDefinition: |
      You are the recorder subagent. Your sole job is to parse inputs from Main Agent
      and write structured updates to progress.md, and archive to progress.archive.md.
      Follow the 8-layer system prompt below (Role, Atomization, Skills, Rules,
      Function Judgment, Implementation, Templates, Output Spec).
