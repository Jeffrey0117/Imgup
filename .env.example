# Next.js Configuration
NEXT_PUBLIC_BASE_URL=http://localhost:3000

# Database Configuration
DATABASE_URL=file:./dev.db

# R2 Configuration (Cloudflare R2 Storage)
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_ACCESS_KEY_ID=your_access_key_id
R2_SECRET_ACCESS_KEY=your_secret_access_key
R2_BUCKET_NAME=your_bucket_name
R2_PUBLIC_URL=https://your-public-url.com

# Admin Configuration
ADMIN_PASSWORD=your_secure_admin_password

# JWT Configuration (Admin)
JWT_SECRET=your-very-secure-jwt-secret-at-least-32-characters-long
JWT_REFRESH_SECRET=your-very-secure-refresh-secret-at-least-32-characters-long

# JWT Configuration (User/Member System)
JWT_USER_SECRET=user-secret-key-min-32-chars-change-in-production
JWT_USER_REFRESH_SECRET=user-refresh-secret-min-32-chars-change-in-production

# ===== API 防護設定 =====

# Rate Limiting 設定 - 分級策略
UPLOAD_RATE_LIMIT_PER_MINUTE=10          # 訪客每分鐘上傳次數（預設 10，會員 30，付費 100）
API_RATE_LIMIT_PER_MINUTE=60             # 訪客每分鐘 API 請求次數（預設 60，會員 120，付費 300）
STRICT_RATE_LIMIT_PER_MINUTE=3           # 訪客敏感操作限制（預設 3，會員 10，付費 30）

# 檔案限制設定
MAX_FILE_SIZE=5242880                    # 最大檔案大小（bytes，預設 5MB）

# 來源驗證設定
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com  # 允許的來源（逗號分隔）
ALLOW_DIRECT_API_CALLS=false             # 是否允許直接 API 呼叫（沒有 Origin/Referer）
ENABLE_ORIGIN_CHECK=true                 # 是否啟用 Origin/Referer 檢查

# IP 管理設定
ENABLE_IP_BLACKLIST=true                 # 是否啟用 IP 黑名單
IP_BLACKLIST=                            # IP 黑名單（逗號分隔，例：192.168.1.100,10.0.0.5）
IP_WHITELIST=                            # IP 白名單（逗號分隔）

# User-Agent 檢查
ENABLE_USER_AGENT_CHECK=true             # 是否檢查可疑的 User-Agent

# 檔案驗證設定
ENABLE_FILE_SIGNATURE_CHECK=true         # 是否驗證檔案簽名（Magic Numbers）
ENABLE_MALICIOUS_CHECK=true              # 是否檢查惡意內容

# 開發環境設定（生產環境請設為 production）
NODE_ENV=development
# 開發環境設定（生產環境請設為 production）
NODE_ENV=development

# Redis Configuration (Upstash Redis for production caching)
# Format: redis://default:password@host:port
REDIS_URL=redis://default:your_upstash_password@your_upstash_host.upstash.io:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=upimg:
REDIS_CACHE_TTL=86400
# ===== Upload Provider 上傳服務商設定 =====

# Urusai API Configuration
URUSAI_API_ENDPOINT=https://api.urusai.cc/v1/upload
URUSAI_TOKEN=                                # 選填：你的 Urusai API Token
URUSAI_R18=0                                 # R18 內容標記 (0=否, 1=是)

# Upload Provider 選擇與優先順序
DEFAULT_UPLOAD_PROVIDER=urusai              # 預設上傳服務 (urusai 或 meteor)
ENABLE_METEOR_FALLBACK=true                 # 是否啟用 Meteor 備援上傳
UPLOAD_PROVIDER_TIMEOUT_MS=12000            # 上傳服務超時時間(毫秒)

# 可疑上傳防護
# true: 阻擋常見站內 Logo 檔名被外部反覆上傳（例：logo-imgup.webp）
# false: 不阻擋
BLOCK_KNOWN_LOGO_UPLOADS=true


# ===== API Key 設定（簡單驗證） =====
# 若設定此值，/api/upload 會要求帶上正確的 API Key 才允許上傳
# 用於僅允許 dukshot 使用
UPLOAD_API_KEY=                             # 建議設為隨機長字串

# ===== Smart Route 智慧路由設定 =====

# 帶副檔名 + 密碼保護時，瀏覽器導向預覽頁功能開關
# true：啟用（瀏覽器直接開啟帶副檔名的有密碼短鏈接 → 轉到預覽頁）
# false：維持現狀（代理直出）
SMART_ROUTE_REDIRECT_EXT_WITH_PASSWORD=false

# 瀏覽器判定模式（嚴格模式）
# true：使用 EdgeDetector 的標準判定（預設，推薦）
# false：放寬判定條件
SMART_ROUTE_BROWSER_NAV_DETECT_STRICT=true